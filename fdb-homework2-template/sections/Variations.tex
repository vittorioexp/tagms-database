\subsection{Variations to the Requirement Analysis}

An employee must necessarily have one and only one role. A role is typically associated with multiple employees but may not have any. For example, the "intern" role can be created but without having hired anyone in that position yet.

An employee must work in at least one department. Each department can have multiple workers, but none if the department is new and newly created.

A manager is an employee with role equals to "Manager". Only they are allowed  to stipulate one or more contracts with many suppliers. A supplier can stipulate many contracts with the manager as well, but a new supplier can also not have stipulated a contract yet. Our system, therefore, is able to also store information relating to suppliers with whom the company has not yet entered into agreements.

Each contract specifies one or more items (e.g., ingredients, packaging materials, etc.) and the respective quantity. An item can be specified in at least one contract, so it can be provided by many different suppliers. Each item belongs to only one item category, and to an item category can belong zero or many items. The stock quantity of each item is tracked. It will therefore be increased upon receipt of the items, after purchase from one or more suppliers, and decreased upon the preparation of lots of products that are made up of the items. The delivery date of the items is specified in each contract, so that the respective quantity in stock is automatically updated only upon arrival of the goods. The company does not use periodic delivery contracts, so every time it becomes necessary to purchase certain ingredients or packaging material, a new contract is signed with the supplier.

A product, which is a finished good ready to be sold, is made up of one or more items (e.g., one glass bottle, a hundred grams of sugar, a hundred milliliters of water, etc.) with the respective quantities. For example, a product called "Coke J" can consist of one aluminum can, 50ml of water, 10g of sugar, etc. Another product, called "Coke B" for example, may have the same ingredients as the previous example but can be packaged with a glass bottle. The expiration date of a product is specified in the various lots (that include that particular product) and it may differ in each lot. The stock quantity of a product is not explicitly specified, but it can be obtained by checking the specified product quantities in each lot not yet sold or shipped. An item can be utilized in many products (also none if, for example, the item is brand new). Each product belongs to one and only one product category, that is used to distinguish them. To a product category can belong zero or many products. The company decides the value of the price increase according to company policies. This increase ("Price\_increase") must take on a value greater than or equal to 1. The price of a product is calculated as a multiplication between the cost of production and the price increase. The expiration date of the ingredients (items) is not tracked as the company guarantees to keep them stored for a short period of time because the ingredients are used shortly after their purchase and a FIFO policy is being implemented. It is not necessary to keep track of the current quantity of products in stock because, in those rare cases where such information is required (i.e. yearly cicle counting), it is possible to check the unsold and not expired lots. Furthermore, it is not necessary to keep track, for each product, of its minimum quantity in stock since most of them are produced on request (and not in advance) and therefore these would have a minimum quantity in stock equal to zero.


A package is composed of one or more packaging materials (i.e., an item used for packaging, such as a box, a meter of plastic tape, a kilogram of polystyrene, etc.) with the respective quantities. For example, a package named "PK1" can consist of 4 boxes of dimensions 30cm x 30cm x 10cm, 2 meters of plastic tape and 200 g of polystyrene. A "PK2" package can consist of 6 boxes of dimensions 30cm x 30cm x 10cm, 4 meters of plastic tape and 300 g of polystyrene. An item (e.g., packaging material in this case) can be utilized in many packages (also none if, for example, the package is brand new and not yet used). Each package belongs to one and only one package category, that is used to distinguish them. To a package category can belong zero or many packages. It is not necessary to explicitly track the current and minimum quantity of packages in stock as it is not in the interests of the company to do so.


In a lot there can be stocked a certain amount of only a product and a certain amount of only a package. The quantity of products in each lot depends both on the dimensions of the package of the individual product (e.g., bottle of glass) and on the features of the package (in particular, the size of the box and the number of boxes that make up the package). Each type of product can be stocked in many lots (in none if, for example, the product is brand new) and the same holds true for packages. The price of a specific lot ("Lot\_price") is calculated as the multiplication of the price of the product (stored in the lot) multiplied by its quantity. It is important to underline that the "Lot\_price" attribute cannot be derived through an online operation as the fields on which it depends ("Production\_Cost" and "Price\_increase") can be modified over time and therefore give discordant results at different times. Each lot is also characterized by an expiration date. As some lots may be produced in advance to reduce lead times, some of them may not sell on time and therefore expire. The data analyst will perform half-yearly analysis in this regard to reduce waste. When a lot is produced, the company specifies the current price and VAT. The cost of the packages is not explicitly charged to the customer. A discount can also be associated with each lot. The company decides the total discount to apply to a specific lot. This discount expresses a percentage and is a number between 0 and 100. Furthermore, the company is able to take into account changes in VAT.

The "Quantity" attribute of the "Item" entity is derived. When a new contract is signed, in the delivery date (specified by the attribute "Delivery\_date" of "Contract") the quantity of each item in the contract is incremented accordingly based on the "Purchased\_Quantity" attribute in the relationship "Specify". This increase will be carried out autonomously by the application connected to the database on the day specified in "Delivery\_date". When a new lot is inserted in the system, each quantity of each item, that constitute the product in the lot, is decremented by a number equal to the multiplications between "Product\_quantity" in "Stocked" and "Quantity" in "Made\_up\_of(1)". The same applies to "Package" entity where the decreasing factor is calculated from the product between "Package\_quantity" and "Quantity" in "Made\_up\_of (2). Immediately after this, for each item involved, the "Quantity" attribute is compared with the "Minimum\_quantity" attribute so a manager will get notified to avoid shortages. Furthermore, the worker, before processing the order, verifies that there are sufficient quantities of items to satisfy the request.

The customer decides with the seller regarding the products to be bought. The salesman, then, after communicating the products (with respective quantity) to the warehouse worker, will place the order only when all the lots included in the order are ready. A seller can place zero or many orders for a customer, so a customer can make many orders (none if, for example, the customer is new). An order can be placed by only one salesman for only one customer (i.e., an order for a customer cannot be placed by two or more sellers, but by only one of them). An order includes one or more lots. Each lot can be included by only one order (none if the lot is produced in advanced and waiting to be ordered). The invoice will be automatically generated by the application linked to the system as soon as the order is placed. The total net amount of the order ("Net\_price") must be calculated as the sum, for each lot $i$ included, of the $ \mathrm{Lot\_price}_i $ * (1 - $ \mathrm{Lot\_discount}_i $ / 100). The total taxes are calculated as the sum, for each lot $i$, of the $ \mathrm{Lot\_price}_i $ * $ \mathrm{VAT}_i $ / 100.
When the order is ready, a worker will ship it: a worker can ship zero or many orders, and an order can be shipped by at most one worker (none if the order is waiting to be shipped). The cancellation and modification of the order is not accepted since the goods can be produced on commission and the company wants to minimize the waste caused by the expiry of the products. The customer, which is a business, must necessarily pay within 60 days and can be informed about the status of the order either by contacting the seller. Furthermore, through the tracking number received by email, the customer can monitor the shipping.
